<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<meta name="google-adsense-account" content="ca-pub-9634304134787821">
	<title>Minecraft Skin Overlay Merger</title>
	<style>
		:root {
			--bg: #0f1220;
			--panel: #171a2b;
			--muted: #8b92b2;
			--accent: #6de39b;
			--danger: #ff6b6b;
			--light: #eef1ff;
			--grid: rgba(255,255,255,0.15);
		}
		html, body {
			background: radial-gradient(1200px 600px at 70% -10%, #1a1f39 0%, #0f1220 60%) fixed;
			color: var(--light);
			font: 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
			margin: 0;
			height: 100%;
		}
		.container {
			max-width: 980px;
			margin: 32px auto;
			padding: 0 16px;
		}
		h1 {
			font-size: 22px;
			margin: 0 0 16px;
			font-weight: 700;
			letter-spacing: 0.2px;
		}
		.sub { color: var(--muted); margin-bottom: 20px; }
		.grid {
			display: grid;
			grid-template-columns: repeat(2, 1fr);
			gap: 16px;
		}
		@media (max-width: 720px) {
			.grid { grid-template-columns: 1fr; }
		}
		.card {
			background: rgba(255,255,255,0.04);
			border: 1px solid rgba(255,255,255,0.08);
			border-radius: 12px;
			padding: 14px;
			backdrop-filter: blur(6px);
		}
		.drop {
			border: 2px dashed rgba(255,255,255,0.18);
			border-radius: 12px;
			padding: 14px;
			display: grid;
			grid-template-columns: 120px 1fr;
			gap: 14px;
			align-items: center;
			transition: border-color .2s, background .2s;
		}
		.drop.dragover {
			border-color: var(--accent);
			background: rgba(109, 227, 155, 0.07);
		}
		.preview {
			width: 120px;
			height: 120px;
			border-radius: 8px;
			background:
				linear-gradient(45deg, var(--grid) 25%, transparent 25%) 0 0/16px 16px,
				linear-gradient(-45deg, var(--grid) 25%, transparent 25%) 0 8px/16px 16px,
				linear-gradient(45deg, transparent 75%, var(--grid) 75%) 8px -8px/16px 16px,
				linear-gradient(-45deg, transparent 75%, var(--grid) 75%) -8px 0/16px 16px,
				#22263d;
			display: grid;
			place-items: center;
			overflow: hidden;
			border: 1px solid rgba(255,255,255,0.1);
		}
		.preview img {
			max-width: 100%;
			max-height: 100%;
			image-rendering: pixelated;
		}
		.controls {
			display: flex;
			flex-wrap: wrap;
			gap: 12px;
			align-items: center;
			justify-content: space-between;
			margin-top: 16px;
		}
		.left, .right { display: flex; gap: 12px; align-items: center; }
		.btn {
			background: linear-gradient(180deg, #7ff0b0, #63d994);
			color: #0b1320;
			border: none;
			padding: 10px 14px;
			border-radius: 10px;
			font-weight: 700;
			cursor: pointer;
			box-shadow: 0 6px 18px rgba(99,217,148,.25);
			transition: transform .06s ease, filter .15s ease;
		}
		.btn:hover { filter: brightness(1.05); }
		.btn:active { transform: translateY(1px); }
		.btn.secondary {
			background: transparent;
			color: var(--light);
			border: 1px solid rgba(255,255,255,0.18);
			box-shadow: none;
		}
		label.file {
			display: inline-flex;
			align-items: center;
			gap: 10px;
			background: rgba(255,255,255,0.06);
			border: 1px solid rgba(255,255,255,0.14);
			padding: 8px 12px;
			border-radius: 10px;
			cursor: pointer;
		}
		input[type="file"] { display: none; }
		.note { color: var(--muted); font-size: 13px; }
		.error { color: var(--danger); font-weight: 600; margin-top: 6px; }
		.checkbox {
			display: inline-flex;
			gap: 8px;
			align-items: center;
			background: rgba(255,255,255,0.06);
			border: 1px solid rgba(255,255,255,0.14);
			padding: 8px 12px;
			border-radius: 10px;
		}
		footer { margin-top: 18px; color: var(--muted); font-size: 13px; }
		code.k { background: rgba(255,255,255,0.08); padding: 2px 6px; border-radius: 6px; }
	</style>
</head>
<body>
	<div class="container">
		<h1>Minecraft Skin Overlay Merger</h1>
		<div class="sub">
			Drop your <b>Base Skin</b> PNG and your <b>Overlay (2nd layer)</b> PNG. We’ll merge them client-side (no upload).
		</div>

		<div class="grid">
			<div class="card">
				<h3>Base Skin</h3>
				<div id="drop-base" class="drop">
					<div class="preview"><img id="img-base" alt="Base preview" /></div>
					<div>
						<div class="note">PNG recommended 64×64. Old 64×32 also works if both match.</div>
						<div style="margin-top:10px">
							<label class="file">
								<input id="file-base" type="file" accept="image/png" />
								<span>Choose PNG…</span>
							</label>
						</div>
						<div id="err-base" class="error" style="display:none"></div>
					</div>
				</div>
			</div>

			<div class="card">
				<h3>Overlay (2nd layer)</h3>
				<div id="drop-ovr" class="drop">
					<div class="preview"><img id="img-ovr" alt="Overlay preview" /></div>
					<div>
						<div class="note">Transparent PNG with only 2nd layer pixels (hat, jacket, sleeves, pants).</div>
						<div style="margin-top:10px">
							<label class="file">
								<input id="file-ovr" type="file" accept="image/png" />
								<span>Choose PNG…</span>
							</label>
						</div>
						<div id="err-ovr" class="error" style="display:none"></div>
					</div>
				</div>
			</div>
		</div>

		<div class="controls">
			<div class="left">
				<label class="checkbox">
					<input id="auto-resize" type="checkbox" />
					<span>Auto-resize overlay to base size</span>
				</label>
				<label class="checkbox">
					<input id="preserve-filename" type="checkbox" checked />
					<span>Use base filename (if available)</span>
				</label>
			</div>
			<div class="right">
				<button id="btn-merge" class="btn">Merge & Download</button>
				<button id="btn-clear" class="btn secondary">Clear</button>
			</div>
		</div>

		<footer>
			Tip: If your overlay image includes base-layer pixels, they’ll still be composited. For strict 2nd-layer validation, preprocess your overlay in an editor and erase unwanted pixels (use <code class="k">nearest-neighbor</code> / “pixelated” to avoid blur).
		</footer>
	</div>

	<canvas id="canvas" width="64" height="64" style="display:none"></canvas>

	<script>
		/* Utility: image loading from File -> HTMLImageElement via DataURL */
		function fileToImage(file) {
			return new Promise((resolve, reject) => {
				const reader = new FileReader();
				reader.onerror = () => reject(new Error("Failed to read file"));
				reader.onload = () => {
					const img = new Image();
					img.onload = () => resolve(img);
					img.onerror = () => reject(new Error("Failed to decode PNG"));
					img.src = reader.result;
				};
				reader.readAsDataURL(file);
			});
		}

		/* State */
		let baseImg = null;
		let overlayImg = null;
		let baseName = "base";

		/* Elements */
		const dropBase = document.getElementById("drop-base");
		const dropOvr = document.getElementById("drop-ovr");
		const imgBase = document.getElementById("img-base");
		const imgOvr = document.getElementById("img-ovr");
		const errBase = document.getElementById("err-base");
		const errOvr = document.getElementById("err-ovr");
		const fileBase = document.getElementById("file-base");
		const fileOvr = document.getElementById("file-ovr");
		const autoResize = document.getElementById("auto-resize");
		const preserveFilename = document.getElementById("preserve-filename");
		const btnMerge = document.getElementById("btn-merge");
		const btnClear = document.getElementById("btn-clear");
		const canvas = document.getElementById("canvas");
		const ctx = canvas.getContext("2d", { willReadFrequently: false });

		function setError(el, msg) {
			el.textContent = msg || "";
			el.style.display = msg ? "block" : "none";
		}

		function handleFiles(kind, files) {
			const file = files && files[0];
			if (!file) return;
			if (file.type !== "image/png") {
				(kind === "base" ? setError(errBase, "Please select a PNG.") : setError(errOvr, "Please select a PNG."));
				return;
			}
			if (kind === "base") baseName = (file.name || "base").replace(/\.png$/i, "");
			(kind === "base" ? setError(errBase, "") : setError(errOvr, ""));

			fileToImage(file).then((img) => {
				// Show preview
				if (kind === "base") {
					baseImg = img;
					imgBase.src = img.src;
				} else {
					overlayImg = img;
					imgOvr.src = img.src;
				}
			}).catch((e) => {
				(kind === "base" ? setError(errBase, e.message) : setError(errOvr, e.message));
			});
		}

		/* Drag & Drop wiring */
		function wireDrop(zone, kind) {
			["dragenter", "dragover"].forEach(ev => {
				zone.addEventListener(ev, (e) => {
					e.preventDefault(); e.stopPropagation();
					zone.classList.add("dragover");
				});
			});
			["dragleave", "drop"].forEach(ev => {
				zone.addEventListener(ev, (e) => {
					e.preventDefault(); e.stopPropagation();
					zone.classList.remove("dragover");
				});
			});
			zone.addEventListener("drop", (e) => {
				const files = e.dataTransfer.files;
				handleFiles(kind, files);
			});
		}
		wireDrop(dropBase, "base");
		wireDrop(dropOvr, "ovr");

		/* File input fallback */
		fileBase.addEventListener("change", (e) => handleFiles("base", e.target.files));
		fileOvr.addEventListener("change", (e) => handleFiles("ovr", e.target.files));

		/* Merge action */
		btnMerge.addEventListener("click", () => {
			setError(errBase, ""); setError(errOvr, "");
			if (!baseImg) { setError(errBase, "Please load a base skin PNG."); return; }
			if (!overlayImg) { setError(errOvr, "Please load an overlay PNG."); return; }

			const bw = baseImg.width, bh = baseImg.height;
			const ow = overlayImg.width, oh = overlayImg.height;

			// Validate / prepare canvas
			canvas.width = bw;
			canvas.height = bh;

			// Draw base
			ctx.clearRect(0, 0, bw, bh);
			ctx.imageSmoothingEnabled = false; // keep pixels crisp
			ctx.drawImage(baseImg, 0, 0, bw, bh);

			// Draw overlay (either same size or scaled if opted-in)
			if (bw === ow && bh === oh) {
				ctx.drawImage(overlayImg, 0, 0);
			} else if (autoResize.checked) {
				ctx.drawImage(overlayImg, 0, 0, ow, oh, 0, 0, bw, bh);
			} else {
				setError(errOvr, `Size mismatch: overlay is ${ow}×${oh}, base is ${bw}×${bh}. Enable "Auto-resize overlay" or provide matching sizes.`);
				return;
			}

			// Download
			const outName = (preserveFilename.checked ? baseName : "merged_skin") + ".png";
			canvas.toBlob((blob) => {
				if (!blob) return;
				const a = document.createElement("a");
				a.href = URL.createObjectURL(blob);
				a.download = outName;
				document.body.appendChild(a);
				a.click();
				URL.revokeObjectURL(a.href);
				a.remove();
			}, "image/png");
		});

		/* Clear */
		btnClear.addEventListener("click", () => {
			baseImg = null; overlayImg = null; baseName = "base";
			imgBase.removeAttribute("src");
			imgOvr.removeAttribute("src");
			setError(errBase, ""); setError(errOvr, "");
			ctx.clearRect(0, 0, canvas.width, canvas.height);
		});
	</script>
</body>
</html>


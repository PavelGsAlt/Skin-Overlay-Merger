<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Minecraft Skin Overlay Merger</title>
  <meta name="description" content="Merge your Minecraft skins with overlays using this client-side tool. No uploads needed - all processing happens in your browser.">
  
  <!-- Google Indexing & SEO -->
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  <meta name="keywords" content="minecraft, skin, overlay, merger, client-side, browser, no-upload, tool, gaming">
  <meta name="author" content="PavelGsAlt">
  <link rel="canonical" href="https://pavelgsalt.github.io/">
  <meta name="google-site-verification" content=""><!-- Add your Google Search Console verification code here -->
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="./favicon.png">
  <link rel="apple-touch-icon" href="./favicon.png">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Minecraft Skin Overlay Merger">
  <meta property="og:description" content="Merge your Minecraft skins with overlays using this client-side tool.">
  <meta property="og:url" content="https://pavelgsalt.github.io/">
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:title" content="Minecraft Skin Overlay Merger">
  <meta property="twitter:description" content="Merge your Minecraft skins with overlays using this client-side tool.">
  
  <!-- Preload critical resources -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"></noscript>
  
  <!-- Preload critical JavaScript dependencies -->
  <link rel="preload" href="https://unpkg.com/react@18/umd/react.production.min.js" as="script">
  <link rel="preload" href="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" as="script">
  <link rel="preload" href="https://unpkg.com/jszip@3.10.1/dist/jszip.min.js" as="script">
  
  <!-- Critical CSS -->
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: Inter, system-ui, -apple-system, sans-serif;
      background: #0f172a;
      color: white;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    #root {
      min-height: 100vh;
      opacity: 1;
      transition: opacity 0.3s ease-in;
    }
    
    #root.loading {
      opacity: 0.95;
    }
    
    .app-container {
      opacity: 0;
      animation: fadeIn 0.5s ease-in-out forwards;
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes pulseGlow {
      0%, 100% {
        box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.15), 0 0 40px rgba(16, 185, 129, 0.12);
      }
      50% {
        box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.15), 0 0 60px rgba(16, 185, 129, 0.18);
      }
    }
    
    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      flex-direction: column;
      gap: 1rem;
    }
    
    .spinner {
      width: 2rem;
      height: 2rem;
      border: 3px solid rgba(16, 185, 129, 0.3);
      border-radius: 50%;
      border-top-color: #10b981;
      animation: spin 1s ease-in-out infinite;
    }
    
    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }
    
    .error {
      text-align: center;
      padding: 2rem;
      max-width: 32rem;
      margin: 0 auto;
    }
    
    .error h2 {
      color: #ef4444;
      margin-bottom: 1rem;
    }
    
    .error p {
      color: #94a3b8;
      line-height: 1.6;
    }
    
    .noscript {
      background: #dc2626;
      color: white;
      padding: 1rem;
      text-align: center;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 9999;
    }
  </style>
  
  <!-- External CSS (non-critical) -->
  <link rel="stylesheet" href="./styles.css">
  <link rel="stylesheet" href="./styles/globals.css">
  <link rel="stylesheet" href="./styles/minecraft-skin.css">
  
  <!-- Three.js -->
  <script src="https://unpkg.com/three@0.150.1/build/three.min.js"></script>
  <!-- SkinView3D -->
  <script src="https://unpkg.com/skinview3d@2.2.0/bundles/skinview3d.bundle.js"></script>
</head>
<body>
  <noscript>
    <div class="noscript">
      <strong>JavaScript is required to run this application.</strong>
      Please enable JavaScript in your browser to continue.
    </div>
  </noscript>
  
  <div id="root" class="loading">
    <div class="loading">
      <div class="spinner"></div>
      <p id="loading-text">Loading Minecraft Skin Overlay Merger...</p>
      <div id="loading-details" style="font-size: 0.875rem; color: #94a3b8; margin-top: 0.5rem;">Initializing dependencies...</div>
    </div>
  </div>
  
  <!-- Enhanced error boundary with dependency checking -->
  <script>
    // Track if the app has started successfully
    let appStarted = false;
    let errorCount = 0;
    let lastErrorTime = 0;
    const MAX_ERRORS = 3;
    const ERROR_TIMEOUT = 2000; // 2 seconds
    
    // Show error only after multiple persistent errors
    function showErrorScreen(message) {
      const root = document.getElementById('root');
      if (root && !appStarted) {
        root.innerHTML = `
          <div class="error">
            <h2>Loading Failed</h2>
            <p>The application failed to load properly. This might be due to network issues or script blocking.</p>
            <p style="margin-top: 1rem;"><strong>Please try:</strong></p>
            <ul style="text-align: left; margin-top: 0.5rem; color: #94a3b8;">
              <li>Refreshing the page</li>
              <li>Checking your internet connection</li>
              <li>Disabling ad blockers temporarily</li>
            </ul>
            <button onclick="location.reload()" style="margin-top: 1rem; padding: 0.5rem 1rem; background: #10b981; color: white; border: none; border-radius: 0.5rem; cursor: pointer;">Refresh Page</button>
            <p style="margin-top: 1rem; font-size: 0.75rem; opacity: 0.7;"><strong>Technical:</strong> ${message}</p>
          </div>
        `;
      }
    }
    
    // More tolerant error handling
    window.addEventListener('error', function(e) {
      const now = Date.now();
      
      // Reset error count if enough time has passed
      if (now - lastErrorTime > ERROR_TIMEOUT) {
        errorCount = 0;
      }
      
      errorCount++;
      lastErrorTime = now;
      
      console.error('Application error:', e.error);
      
      // Only show error screen after multiple rapid errors and app hasn't started
      if (errorCount >= MAX_ERRORS && !appStarted) {
        showErrorScreen(e.error?.message || 'Multiple script errors detected');
      }
    });
    
    // Handle promise rejections more gracefully
    window.addEventListener('unhandledrejection', function(e) {
      console.error('Unhandled promise rejection:', e.reason);
      // Don't show error screen for promise rejections unless they're critical
      if (e.reason && e.reason.message && e.reason.message.includes('React')) {
        errorCount++;
        if (errorCount >= MAX_ERRORS && !appStarted) {
          showErrorScreen('React initialization failed: ' + e.reason.message);
        }
      }
    });
    
    // Mark app as started when React successfully renders
    window.markAppStarted = function() {
      appStarted = true;
      errorCount = 0;
      
      // Add smooth transition when app loads
      const root = document.getElementById('root');
      if (root) {
        root.classList.remove('loading');
      }
    };
    
    // Update loading status as dependencies load
    let loadedDeps = [];
    const totalDeps = ['React', 'ReactDOM', 'Babel', 'Three.js', 'SkinView3D', 'JSZip'];
    
    function updateLoadingStatus() {
      const loadingDetails = document.getElementById('loading-details');
      if (!loadingDetails || appStarted) return;
      
      loadedDeps = [];
      if (window.React) loadedDeps.push('React');
      if (window.ReactDOM) loadedDeps.push('ReactDOM');
      if (window.Babel) loadedDeps.push('Babel');
      if (window.THREE) loadedDeps.push('Three.js');
      if (window.skinview3d) loadedDeps.push('SkinView3D');
      if (window.JSZip) loadedDeps.push('JSZip');
      
      const progress = Math.round((loadedDeps.length / totalDeps.length) * 100);
      loadingDetails.textContent = `Loading dependencies... ${progress}% (${loadedDeps.length}/${totalDeps.length})`;
      
      if (loadedDeps.length === totalDeps.length) {
        loadingDetails.textContent = 'All dependencies loaded! Starting application...';
      }
    }
    
    // Check loading status periodically
    const statusInterval = setInterval(() => {
      if (appStarted) {
        clearInterval(statusInterval);
        return;
      }
      updateLoadingStatus();
    }, 200);
    
    // Safety timeout - if app doesn't start within 15 seconds, show fallback
    setTimeout(() => {
      if (!appStarted) {
        const loadingDetails = document.getElementById('loading-details');
        if (loadingDetails) {
          loadingDetails.innerHTML = `
            <div style="color: #f59e0b; margin-top: 0.5rem;">
              ⚠️ Loading is taking longer than expected.<br>
              <button onclick="location.reload()" style="margin-top: 0.5rem; padding: 0.25rem 0.5rem; background: #10b981; color: white; border: none; border-radius: 0.25rem; cursor: pointer; font-size: 0.75rem;">Refresh Page</button>
            </div>
          `;
        }
        clearInterval(statusInterval);
      }
    }, 15000);
  </script>
  
  <!-- React and ReactDOM from CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  
  <!-- Babel for JSX transformation -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  

  <!-- JSZip for handling ZIP files -->
  <script src="https://unpkg.com/jszip@3.10.1/dist/jszip.min.js"></script>
  
  <!-- Overlay ZIP Configuration and Services -->
  <script src="./overlay-config.js"></script>
  <script src="./overlay-service.js"></script>
  
  <!-- Main application script -->
  <script type="text/babel" src="./main.js"></script>
</body>
</html>